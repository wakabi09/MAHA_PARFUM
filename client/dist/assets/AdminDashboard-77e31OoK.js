import{j as e,L as f,r as c}from"./index-DMg7K7Es.js";import{a as l}from"./index-xsH4HHeE.js";const N=({children:s})=>{const t=()=>{localStorage.removeItem("token"),window.location.href="/login"};return e.jsxs("div",{className:"wrapper",children:[e.jsx("nav",{className:"main-header navbar navbar-expand navbar-white navbar-light",children:e.jsxs("ul",{className:"navbar-nav w-100 justify-content-between align-items-center",children:[e.jsxs("div",{className:"d-flex",children:[e.jsx("li",{className:"nav-item",children:e.jsx("a",{className:"nav-link","data-widget":"pushmenu",href:"#",role:"button",children:e.jsx("i",{className:"fas fa-bars"})})}),e.jsx("li",{className:"nav-item d-none d-sm-inline-block",children:e.jsx(f,{to:"/",className:"nav-link",children:"Kembali ke Toko"})})]}),e.jsx("li",{className:"nav-item",children:e.jsxs("button",{className:"btn btn-danger btn-sm",onClick:t,children:[e.jsx("i",{className:"fas fa-sign-out-alt"})," Logout"]})})]})}),e.jsx("div",{className:"content-wrapper p-3",children:s})]})},y=()=>{const[s,t]=c.useState({name:"",price:"",description:"",brand:"",countInStock:"",notes:"",imageFile:null,image:""}),[u,x]=c.useState([]),[n,o]=c.useState(null);c.useEffect(()=>{d()},[]);const d=async()=>{try{const a=await l.get("http://localhost:5000/api/products");x(a.data)}catch(a){console.error("Gagal fetch produk:",a)}},r=a=>{t({...s,[a.target.name]:a.target.value})},p=a=>{t({...s,imageFile:a.target.files[0]})},j=async a=>{a.preventDefault();try{let i=s.image;if(s.imageFile){const h=new FormData;h.append("image",s.imageFile),i=(await l.post("http://localhost:5000/api/upload",h)).data.filename}const m={name:s.name,price:Number(s.price),description:s.description,brand:s.brand,countInStock:Number(s.countInStock),notes:s.notes,image:i};n?(await l.put(`http://localhost:5000/api/products/${n}`,m),alert("Produk berhasil diperbarui!")):(await l.post("http://localhost:5000/api/products",m),alert("Produk berhasil ditambahkan!")),t({name:"",price:"",description:"",brand:"",countInStock:"",notes:"",imageFile:null,image:""}),o(null),d()}catch(i){console.error("Error:",i),alert("Terjadi kesalahan.")}},b=a=>{t({name:a.name,price:a.price,description:a.description,brand:a.brand,countInStock:a.countInStock,notes:a.notes||"",imageFile:null,image:a.image}),o(a.id)},g=async a=>{if(window.confirm("Yakin ingin menghapus produk ini?"))try{await l.delete(`http://localhost:5000/api/products/${a}`),alert("Produk berhasil dihapus!"),d()}catch(i){console.error("Gagal hapus produk:",i),alert("Gagal menghapus produk.")}};return e.jsxs(N,{children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-primary text-white",children:e.jsxs("h3",{className:"card-title",children:[e.jsx("i",{className:`fas ${n?"fa-edit":"fa-plus-circle"}`})," ",n?"Edit Produk":"Tambah Produk"]})}),e.jsxs("form",{onSubmit:j,children:[e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nama Produk"}),e.jsx("input",{type:"text",name:"name",className:"form-control",value:s.name,onChange:r,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Harga"}),e.jsx("input",{type:"number",name:"price",className:"form-control",value:s.price,onChange:r,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Deskripsi"}),e.jsx("textarea",{name:"description",className:"form-control",value:s.description,onChange:r,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Notes"}),e.jsx("textarea",{name:"notes",className:"form-control",value:s.notes,onChange:r})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Gambar"}),e.jsx("input",{type:"file",accept:"image/*",className:"form-control",onChange:p})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Brand"}),e.jsx("input",{type:"text",name:"brand",className:"form-control",value:s.brand,onChange:r,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Stok"}),e.jsx("input",{type:"number",name:"countInStock",className:"form-control",value:s.countInStock,onChange:r,required:!0})]})]}),e.jsxs("div",{className:"card-footer",children:[e.jsxs("button",{type:"submit",className:"btn btn-success me-2",children:[e.jsx("i",{className:`fas ${n?"fa-save":"fa-plus"}`})," ",n?"Update":"Tambah"," Produk"]}),n&&e.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:()=>{o(null),t({name:"",price:"",description:"",brand:"",countInStock:"",notes:"",imageFile:null,image:""})},children:[e.jsx("i",{className:"fas fa-times"})," Batal Edit"]})]})]})]}),e.jsxs("div",{className:"card mt-4",children:[e.jsx("div",{className:"card-header bg-info text-white",children:e.jsxs("h3",{className:"card-title",children:[e.jsx("i",{className:"fas fa-boxes"})," Daftar Produk"]})}),e.jsx("div",{className:"card-body",children:e.jsxs("table",{className:"table table-bordered table-striped",children:[e.jsx("thead",{className:"thead-dark",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Gambar"}),e.jsx("th",{children:"Nama"}),e.jsx("th",{children:"Harga"}),e.jsx("th",{children:"Deskripsi"}),e.jsx("th",{children:"Notes"}),e.jsx("th",{children:"Aksi"})]})}),e.jsx("tbody",{children:u.map(a=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("img",{src:`http://localhost:5000/assets/${a.image}`,alt:a.name,width:"80"})}),e.jsx("td",{children:a.name}),e.jsxs("td",{children:["Rp ",a.price]}),e.jsx("td",{children:a.description}),e.jsx("td",{children:a.notes||"-"}),e.jsxs("td",{children:[e.jsxs("button",{className:"btn btn-warning btn-sm me-2",onClick:()=>b(a),children:[e.jsx("i",{className:"fas fa-edit"})," Edit"]}),e.jsxs("button",{className:"btn btn-danger btn-sm",onClick:()=>g(a.id),children:[e.jsx("i",{className:"fas fa-trash-alt"})," Hapus"]})]})]},a.id))})]})})]})]})};export{y as default};
